# Smart Inventory with QR system

Мини-приложение на FastAPI для учёта оборудования с QR-кодами, Bootstrap-интерфейсом и простыми ролями доступа.

## Возможности
- Добавление оборудования (название, местоположение, заметки) с автоматическим UUID и PNG QR-кодом.
- Просмотр списка, карточки предмета, QR-изображения, статуса и истории действий.
- Html5-QRCode страница `/scan` для моментального перехода на `/item/{uuid}` после сканирования.
- Журнал событий (создание, смена статуса, произвольные действия).
- Авторизация и роли: **admin** может создавать/редактировать/удалять и менять статус, обычный пользователь видит данные и может сканировать.

## Структура
```
project/
├─ app/
│  ├─ main.py       # FastAPI маршруты, странички и авторизация
│  ├─ database.py   # SQLite + SQLAlchemy
│  ├─ models.py     # Таблицы пользователей, оборудования и истории
│  ├─ crud.py       # Логика БД + генерация QR-кодов
│  ├─ schemas.py    # Pydantic-схемы API
│  └─ auth.py       # Хеширование паролей
├─ templates/       # Jinja2 + Bootstrap 5
├─ static/qrcodes/  # PNG-файлы QR
├─ requirements.txt
└─ README.md
```

## Установка зависимостей
```powershell
pip install -r requirements.txt
```
(Работайте в виртуальном окружении на Python 3.11+.)

## Запуск
```powershell
uvicorn app.main:app --reload
```
После запуска открывайте:
- `http://127.0.0.1:8000` — форма/список.
- `http://127.0.0.1:8000/scan` — веб-сканер.

## Авторизация
При первом старте автоматически создаётся администратор:
- Логин: `admin`
- Пароль: `admin`
Зайдите под ним и сразу поменяйте пароль/создайте нового пользователя (например, через SQLite-браузер или отдельный CRUD-скрипт). Без входа можно только просматривать данные и сканировать.

## API
- `POST /equipment/add` — JSON `{ "name": "...", "location": "...", "notes": "optional" }`
- `GET /equipment/{uuid}` — карточка оборудования
- `PATCH /equipment/{uuid}` — обновить название/локацию/заметки (только admin)
- `PATCH /equipment/{uuid}/status` — сменить статус (admin)
- `POST /equipment/{uuid}/history` — добавить запись истории (admin)
- `DELETE /equipment/{uuid}` — удалить (admin)
- `GET /scan`, `GET /` — веб-страницы

## Примечания
- HTML-формы используют те же API-эндпоинты, защита выполняется на сервере.
- Папка `static/qrcodes` должна существовать и доступна для записи — туда сохраняются PNG.
- QR код содержит UUID, поэтому сканирование с любого устройства сразу открывает `/item/{uuid}`.
